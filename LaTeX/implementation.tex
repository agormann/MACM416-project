\documentclass{myproject}

\graphicspath{{../Figures/}}

% title setup
\title{\vspace*{-1cm}Solution to the Inviscid Burgers' Equation by the Lax-Friedrichs Scheme\footnote{Placeholder title!}}
\date{}
\author{
    Andre Gormann\\
    agormann@sfu.ca
    \and
    Ethan MacDonald\\
    jem21@sfu.ca
}

% bibliography
\addbibresource{references.bib}

\renewcommand*{\thefootnote}{[\arabic{footnote}]}

\begin{document}

% title creation
\maketitle
\vspace*{-1cm}

% document 

\section{Introduction}

The problem we will be considering is the Inviscid Burgers' equation with periodic boundary conditions
\begin{equation}
    \begin{cases}
        & u_t + uu_x = 0 \qquad x \in [-L, L] \qquad t \geq 0 \\
        & u(x,0) = u_0(x) \\
        & u(-L,t) = u(L,t)
    \end{cases}
\end{equation}

Throughout the ensuing discussion, it will be far more useful if we rewrite the inviscid Burgers' equation in its conservation form
\begin{equation}
    u_t + f(u)_x = 0 \qquad f(u) = \frac{1}{2}u^2
\end{equation}

We have chosen to use the Lax-Friedrichs scheme to approximate solutions of the Inviscid Burgers equation. The scheme is defined by the update rule

\[
    U_j^{n+1} = \frac{1}{2}\left( U_{j-1}^{n} + U_{j+1}^{n} \right) - \frac{\Delta t}{2\Delta x}\left( f(U_{j+1}^{n}) - f(U_{j-1}^{n}) \right)
\]
where $U_{j}^{n} \in \R^N$ denotes the approximation to $u(x_j,t_n)$ at time $t_n$

The scheme combines updates in the spacial domain with time-stepping. Our reasoning for choosing the Lax-Friedrichs scheme is found in the second term of the update rule. This term applies a sort of dampening effect at each time-step based on the flow between grid cells. We hope that this will work to improve accuracy around shocks when they form in the solution. Another advantage of the Lax-Friedrich's scheme is that we can guarantee stability through the choices of ${\Delta t}$ and ${\Delta x}$, so long as we can bound $|u|$. This will be elaborated upon later in the document. We will be using periodic boundary conditions because the Inviscid Burgers' equation deals with wave propagation.

\section{Theory}

We begin by discretizing the interval $[-L,L]$ by defining a mesh width $\Delta x = 2L/N$ so that 
\[
    x_j = -L + j\Delta x \qquad x_{j+1/2} = x_j + \frac{\Delta x}{2}
\]
We will also denote the time step by $\Delta t_n$ so that
\[
    t_n = n\Delta t_n
\]
The exact formula for $\Delta t_n$ will remain undefined for now as it must be a variable time-step.

We denote the \emph{pointwise values} of the true solution at the mesh point $(x_j, t_n)$ by 
\[
    u_j^n = u(x_j,t_n)
\]
and the \emph{cell average} of the true solution 
\[
    \bar{u}_j^n = \frac{1}{\Delta x} \int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t_n) dx
\]

\[
    \int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t_{n+1}) dx = \int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t_{n}) dx - \left[ \int_{t_n}^{t_{n+1}} f(u(x_{j+1/2},t)) dx - \int_{t_n}^{t_{n+1}} f(u(x_{j-1/2},t)) dx \right]
\]

We say that a method is in \emph{conservation form} if 
\[
    U_j^{n+1} = U_j^n - \frac{\Delta t}{\Delta x} \left[ \mathcal{F}(U_{j}^{n}, U_{j+1}^{n}) - \mathcal{F}(U_{j-1}^{n}, U_{j}^{n}) \right]
\]

\[
    \bar{u}_j^{n+1} = \bar{u}_j^n - \frac{1}{\Delta x}\left[ \int_{t_n}^{t_{n+1}} f(u(x_{j+1/2},t)) dx - \int_{t_n}^{t_{n+1}} f(u(x_{j-1/2},t)) dx \right]
\]

So the numerical flux function $\mathcal{F}$ plays the role of an average flux through $x_{j\pm1/2}$ over the time interval $[t_n, t_{n+1}]$
\[
    \mathcal{F}(U_j^n, U_{j+1}^n) \sim \frac{1}{\Delta x} \int_{t_n}^{t_{n+1}} f(u(x_{j+1/2}, t)) dt \qquad \mathcal{F}(U_{j-1}^n, U_{j}^n) \sim \frac{1}{\Delta x} \int_{t_n}^{t_{n+1}} f(u(x_{j-1/2}, t)) dt
\]

\section{Matrix Form of the Lax-Friedrichs Scheme}
The Lax-Friedrichs scheme
\[
    U_j^{n+1} = \frac{1}{2}\left( U_{j-1}^{n} + U_{j+1}^{n} \right) - \frac{\Delta t}{2\Delta x}\left( f(U_{j+1}^{n}) - f(U_{j-1}^{n}) \right)
\]

can be converted into a matrix form

\[
\vec{U}^{n+1} = A\vec{U}^{n} - B\vec{f}(\vec{U}^{n})
\]

where

\[
A = \frac{1}{2}
\begin{bmatrix}
0 & 1 & 0 & \dots & 0 & 1 \\
1 & 0 & 1 & \dots & 0 & 0 \\
0 & 1 & 0 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & 0 & 1 \\
1 & 0 & 0 & \dots & 1 & 0
\end{bmatrix},
\quad
B = \frac{\Delta t}{2 \Delta x}
\begin{bmatrix}
0 & 1 & 0 & \dots & 0 & -1 \\
-1 & 0 & 1 & \dots & 0 & 0 \\
0 & -1 & 0 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & 0 & 1 \\
1 & 0 & 0 & \dots & -1 & 0
\end{bmatrix}
\]

If we instead use the conservation form of the Lax-Friedrichs scheme

\[
    U_j^{n+1} = U_j^n - \frac{\Delta t}{\Delta x} \left( \mathcal{F}(U_{j}^{n}, U_{j+1}^{n}) - \mathcal{F}(U_{j-1}^{n}, U_{j}^{n}) \right)
\]

\[
    \mathcal{F}(U_j^n, U_{j+1}^n) := \frac{\Delta x}{2 \Delta t}(U_j^n - U_{j+1}^n) + \frac{1}{2}\left( f(U_j^n) + f(U_{j+1}^n) \right)
\]

we get the following matrix form

\[
\vec{U}^{n+1} = \vec{U}^{n} - C\vec{\mathcal{F}}(\vec{U}^{n})
\]

\[
\vec{\mathcal{F}}(\vec{U}^{n}) = D\vec{U}^{n} + E\vec{f}(\vec{U}^{n})
\]

where

\[
C = \frac{\Delta x}{\Delta t}
\begin{bmatrix}
-1 & 1 & 0 & \dots & 0 & 0 \\
0 & -1 & 1 & \dots & 0 & 0 \\
0 & 0 & -1 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & -1 & 1 \\
1 & 0 & 0 & \dots & 0 & -1
\end{bmatrix},
\]
\[
D = \frac{\Delta x}{2 \Delta t}
\begin{bmatrix}
-1 & 0 & 0 & \dots & 0 & 1 \\
1 & -1 & 0 & \dots & 0 & 0 \\
0 & 1 & -1 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & -1 & 0 \\
0 & 0 & 0 & \dots & 1 & -1
\end{bmatrix},
\quad
E = \frac{1}{2}
\begin{bmatrix}
1 & 0 & 0 & \dots & 0 & 1 \\
1 & 1 & 0 & \dots & 0 & 0 \\
0 & 1 & 1 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & 1 & 0 \\
0 & 0 & 0 & \dots & 1 & 1
\end{bmatrix}
\]

In either case, we can construct the matrices in MATLAB by using the \textit{diag()} command on vectors containing the values of the non-zero diagonals, then filling in the values in the bottom left and top right corners as necessary, and lastly multiplying by the respective coefficient.

We will be using the matrices defined in this section to implement our periodic boundary conditions. The entries in the bottom left and top right corners of the matrices handle the cases where a value from beyond the periodic boundaries is needed.

\section{Conclusion}

% bibliography
% \nocite{choksi2022}
\nocite{iserles2009}
% \nocite{kutz2013}
\nocite{trefethen2000}
% \nocite{learncfd}
% \nocite{evans2010}
\nocite{leveque1992}
\nocite{leveque2002}
\printbibliography

\end{document}